WITH ASD as(
SELECT DISTINCT COSTCENTER,CONFIRMDATE,WORKCENTER FROM IASPRDCONF WHERE  CONFIRMDATE > CAST(DATEADD(DAY,-30,GETDATE()) AS DATE)
AND COSTCENTER IN ('CNC','TASLAMA','CNCTORNA','MONTAJ'))
SELECT COSTCENTER,CONFIRMDATE,COUNT(WORKCENTER) as COUNTOFWC FROM ASD
GROUP BY CONFIRMDATE,COSTCENTER
ORDER BY COSTCENTER,CONFIRMDATE